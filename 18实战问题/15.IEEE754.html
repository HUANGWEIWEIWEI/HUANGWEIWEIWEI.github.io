<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>15.IEEE 754 | FE Note</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/avater.jpg">
    <meta name="description" content="持续更新的前端学习笔记">
    <link rel="preload" href="/assets/css/0.styles.1f6703fb.css" as="style"><link rel="preload" href="/assets/js/app.7cfd3afd.js" as="script"><link rel="preload" href="/assets/js/2.7c2e0a4d.js" as="script"><link rel="preload" href="/assets/js/119.379e4cb6.js" as="script"><link rel="preload" href="/assets/js/5.bf8043b7.js" as="script"><link rel="prefetch" href="/assets/js/10.a199202b.js"><link rel="prefetch" href="/assets/js/100.973d1ec8.js"><link rel="prefetch" href="/assets/js/101.b90a93b7.js"><link rel="prefetch" href="/assets/js/102.98ac1f0c.js"><link rel="prefetch" href="/assets/js/103.d9c215a7.js"><link rel="prefetch" href="/assets/js/104.5d65fbc4.js"><link rel="prefetch" href="/assets/js/105.bef8cee6.js"><link rel="prefetch" href="/assets/js/106.8137498e.js"><link rel="prefetch" href="/assets/js/107.9a2d8d32.js"><link rel="prefetch" href="/assets/js/108.91221e7a.js"><link rel="prefetch" href="/assets/js/109.74935341.js"><link rel="prefetch" href="/assets/js/11.05cffb54.js"><link rel="prefetch" href="/assets/js/110.bf26cbb0.js"><link rel="prefetch" href="/assets/js/111.42631527.js"><link rel="prefetch" href="/assets/js/112.f23920e3.js"><link rel="prefetch" href="/assets/js/113.e8287c5e.js"><link rel="prefetch" href="/assets/js/114.2329100e.js"><link rel="prefetch" href="/assets/js/115.4bec32d8.js"><link rel="prefetch" href="/assets/js/116.7154ce05.js"><link rel="prefetch" href="/assets/js/117.fbf691f9.js"><link rel="prefetch" href="/assets/js/118.5a34128f.js"><link rel="prefetch" href="/assets/js/12.bd400654.js"><link rel="prefetch" href="/assets/js/120.598e648b.js"><link rel="prefetch" href="/assets/js/121.982b9b7b.js"><link rel="prefetch" href="/assets/js/122.8eaec69e.js"><link rel="prefetch" href="/assets/js/123.33e552cb.js"><link rel="prefetch" href="/assets/js/124.a53b101e.js"><link rel="prefetch" href="/assets/js/125.69371d5d.js"><link rel="prefetch" href="/assets/js/126.03a8b253.js"><link rel="prefetch" href="/assets/js/127.d3ee57ee.js"><link rel="prefetch" href="/assets/js/128.6a3426b0.js"><link rel="prefetch" href="/assets/js/129.c7aaea2f.js"><link rel="prefetch" href="/assets/js/13.f5a78c38.js"><link rel="prefetch" href="/assets/js/130.c40b9f00.js"><link rel="prefetch" href="/assets/js/131.47e56597.js"><link rel="prefetch" href="/assets/js/132.853618fc.js"><link rel="prefetch" href="/assets/js/133.745244a8.js"><link rel="prefetch" href="/assets/js/134.df063492.js"><link rel="prefetch" href="/assets/js/135.bf073385.js"><link rel="prefetch" href="/assets/js/136.da6fc2af.js"><link rel="prefetch" href="/assets/js/137.4340c29e.js"><link rel="prefetch" href="/assets/js/138.bcb0c951.js"><link rel="prefetch" href="/assets/js/139.248d092e.js"><link rel="prefetch" href="/assets/js/14.ac1d06ab.js"><link rel="prefetch" href="/assets/js/140.92ea591d.js"><link rel="prefetch" href="/assets/js/141.596f87e5.js"><link rel="prefetch" href="/assets/js/15.ecedfca9.js"><link rel="prefetch" href="/assets/js/16.ee8fa0aa.js"><link rel="prefetch" href="/assets/js/17.67df96c4.js"><link rel="prefetch" href="/assets/js/18.4ab8d709.js"><link rel="prefetch" href="/assets/js/19.9ba3846e.js"><link rel="prefetch" href="/assets/js/20.d8fc77f6.js"><link rel="prefetch" href="/assets/js/21.159f491c.js"><link rel="prefetch" href="/assets/js/22.6d53e019.js"><link rel="prefetch" href="/assets/js/23.c88a646f.js"><link rel="prefetch" href="/assets/js/24.81f5a0c5.js"><link rel="prefetch" href="/assets/js/25.b1d65cf7.js"><link rel="prefetch" href="/assets/js/26.190f5736.js"><link rel="prefetch" href="/assets/js/27.6c00da31.js"><link rel="prefetch" href="/assets/js/28.6aee56fe.js"><link rel="prefetch" href="/assets/js/29.4c49b541.js"><link rel="prefetch" href="/assets/js/3.5e85fdcc.js"><link rel="prefetch" href="/assets/js/30.46ad2c22.js"><link rel="prefetch" href="/assets/js/31.dbbbf982.js"><link rel="prefetch" href="/assets/js/32.5da420f8.js"><link rel="prefetch" href="/assets/js/33.5b6ab24d.js"><link rel="prefetch" href="/assets/js/34.23208694.js"><link rel="prefetch" href="/assets/js/35.c6f53d20.js"><link rel="prefetch" href="/assets/js/36.c18b4f91.js"><link rel="prefetch" href="/assets/js/37.e7b8b9ff.js"><link rel="prefetch" href="/assets/js/38.be4a3f12.js"><link rel="prefetch" href="/assets/js/39.7040e244.js"><link rel="prefetch" href="/assets/js/4.214c66dd.js"><link rel="prefetch" href="/assets/js/40.91851cc6.js"><link rel="prefetch" href="/assets/js/41.112012b0.js"><link rel="prefetch" href="/assets/js/42.fe20d2f5.js"><link rel="prefetch" href="/assets/js/43.6d27b363.js"><link rel="prefetch" href="/assets/js/44.8352cc33.js"><link rel="prefetch" href="/assets/js/45.ab0bc7de.js"><link rel="prefetch" href="/assets/js/46.16bfc8d2.js"><link rel="prefetch" href="/assets/js/47.762e7926.js"><link rel="prefetch" href="/assets/js/48.4e3fb577.js"><link rel="prefetch" href="/assets/js/49.d39d6217.js"><link rel="prefetch" href="/assets/js/50.29e9f8d1.js"><link rel="prefetch" href="/assets/js/51.6095d6bd.js"><link rel="prefetch" href="/assets/js/52.df8225fd.js"><link rel="prefetch" href="/assets/js/53.bcde160c.js"><link rel="prefetch" href="/assets/js/54.30cb1212.js"><link rel="prefetch" href="/assets/js/55.3ec7d6c7.js"><link rel="prefetch" href="/assets/js/56.e3e525f5.js"><link rel="prefetch" href="/assets/js/57.39f005f2.js"><link rel="prefetch" href="/assets/js/58.d69af7e0.js"><link rel="prefetch" href="/assets/js/59.a352d3a0.js"><link rel="prefetch" href="/assets/js/6.b7c61ba1.js"><link rel="prefetch" href="/assets/js/60.de7b9265.js"><link rel="prefetch" href="/assets/js/61.433c57ff.js"><link rel="prefetch" href="/assets/js/62.8dfb2c78.js"><link rel="prefetch" href="/assets/js/63.4d90d359.js"><link rel="prefetch" href="/assets/js/64.e7f370d9.js"><link rel="prefetch" href="/assets/js/65.9c71852f.js"><link rel="prefetch" href="/assets/js/66.eba29aba.js"><link rel="prefetch" href="/assets/js/67.a6c462bf.js"><link rel="prefetch" href="/assets/js/68.a54fecea.js"><link rel="prefetch" href="/assets/js/69.260ede44.js"><link rel="prefetch" href="/assets/js/7.499bf40e.js"><link rel="prefetch" href="/assets/js/70.ed02f564.js"><link rel="prefetch" href="/assets/js/71.835fd3be.js"><link rel="prefetch" href="/assets/js/72.dbab8cc7.js"><link rel="prefetch" href="/assets/js/73.80924fab.js"><link rel="prefetch" href="/assets/js/74.ede54dd0.js"><link rel="prefetch" href="/assets/js/75.4d0e9dd3.js"><link rel="prefetch" href="/assets/js/76.311c4ab7.js"><link rel="prefetch" href="/assets/js/77.2f189c53.js"><link rel="prefetch" href="/assets/js/78.e4a2d6f5.js"><link rel="prefetch" href="/assets/js/79.19b5e848.js"><link rel="prefetch" href="/assets/js/8.3525ff20.js"><link rel="prefetch" href="/assets/js/80.5ad884ee.js"><link rel="prefetch" href="/assets/js/81.555bb3aa.js"><link rel="prefetch" href="/assets/js/82.24bd7c19.js"><link rel="prefetch" href="/assets/js/83.2af9cde1.js"><link rel="prefetch" href="/assets/js/84.9361ff2b.js"><link rel="prefetch" href="/assets/js/85.b3ba2103.js"><link rel="prefetch" href="/assets/js/86.8de2f7bc.js"><link rel="prefetch" href="/assets/js/87.0467f1e3.js"><link rel="prefetch" href="/assets/js/88.4f7266c8.js"><link rel="prefetch" href="/assets/js/89.7de85c62.js"><link rel="prefetch" href="/assets/js/9.b0e8a85f.js"><link rel="prefetch" href="/assets/js/90.547a7230.js"><link rel="prefetch" href="/assets/js/91.cba95ce0.js"><link rel="prefetch" href="/assets/js/92.48eb37c8.js"><link rel="prefetch" href="/assets/js/93.2c0a2097.js"><link rel="prefetch" href="/assets/js/94.79de61d2.js"><link rel="prefetch" href="/assets/js/95.9ceca60f.js"><link rel="prefetch" href="/assets/js/96.fab3711b.js"><link rel="prefetch" href="/assets/js/97.ec3690c4.js"><link rel="prefetch" href="/assets/js/98.11585efa.js"><link rel="prefetch" href="/assets/js/99.ae7a2943.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1f6703fb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/avater.jpg" alt="FE Note" class="logo"> <span class="site-name can-hide">FE Note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/01html相关/1.HTML、HTML5概述.html" class="nav-link">
  HTML/5
</a></div><div class="nav-item"><a href="/02css相关/1.CSS、CSS3概述.html" class="nav-link">
  CSS/3
</a></div><div class="nav-item"><a href="/03js相关/01JS概述.html" class="nav-link">
  JS/ES6
</a></div><div class="nav-item"><a href="/04vue/01Vue概述.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/05node/1.Node.js概述.html" class="nav-link">
  NodeJS
</a></div><div class="nav-item"><a href="/06数据库/1.数据库概述.html" class="nav-link">
  数据库
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="四大必修" class="dropdown-title"><span class="title">四大必修</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/07数据结构/01数据结构概述.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/08算法/01算法.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/09计算机网络和浏览器/1.计算机网络.html" class="nav-link">
  计算机网络和浏览器
</a></li><li class="dropdown-item"><!----> <a href="/10操作系统/1.操作系统（基础）.html" class="nav-link">
  操作系统
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="OTHER" class="dropdown-title"><span class="title">OTHER</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/11小程序/01小程序概述.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/12前端工程化/01前端工程化概述.html" class="nav-link">
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/13前端安全/01前端安全概述.html" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/14VS-Code/0.vscode相关.html" class="nav-link">
  VS Code
</a></li><li class="dropdown-item"><!----> <a href="/15Chrome/01chrome概述.html" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/16Git/1.git概述.html" class="nav-link">
  Git相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tips" class="dropdown-title"><span class="title">Tips</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/17生词本/1.学习中遇到的生词.html" class="nav-link">
  生词本
</a></li><li class="dropdown-item"><!----> <a href="/19书籍阅读/0书籍汇总.html" class="nav-link">
  书籍阅读
</a></li><li class="dropdown-item"><!----> <a href="/20项目/0项目汇总.html" class="nav-link">
  项目
</a></li></ul></div></div><div class="nav-item"><a href="/18实战问题/0.实战中遇到的问题归纳.html" class="nav-link">
  实战问题
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/01html相关/1.HTML、HTML5概述.html" class="nav-link">
  HTML/5
</a></div><div class="nav-item"><a href="/02css相关/1.CSS、CSS3概述.html" class="nav-link">
  CSS/3
</a></div><div class="nav-item"><a href="/03js相关/01JS概述.html" class="nav-link">
  JS/ES6
</a></div><div class="nav-item"><a href="/04vue/01Vue概述.html" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/05node/1.Node.js概述.html" class="nav-link">
  NodeJS
</a></div><div class="nav-item"><a href="/06数据库/1.数据库概述.html" class="nav-link">
  数据库
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="四大必修" class="dropdown-title"><span class="title">四大必修</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/07数据结构/01数据结构概述.html" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/08算法/01算法.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/09计算机网络和浏览器/1.计算机网络.html" class="nav-link">
  计算机网络和浏览器
</a></li><li class="dropdown-item"><!----> <a href="/10操作系统/1.操作系统（基础）.html" class="nav-link">
  操作系统
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="OTHER" class="dropdown-title"><span class="title">OTHER</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/11小程序/01小程序概述.html" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/12前端工程化/01前端工程化概述.html" class="nav-link">
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/13前端安全/01前端安全概述.html" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/14VS-Code/0.vscode相关.html" class="nav-link">
  VS Code
</a></li><li class="dropdown-item"><!----> <a href="/15Chrome/01chrome概述.html" class="nav-link">
  Chrome
</a></li><li class="dropdown-item"><!----> <a href="/16Git/1.git概述.html" class="nav-link">
  Git相关
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Tips" class="dropdown-title"><span class="title">Tips</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/17生词本/1.学习中遇到的生词.html" class="nav-link">
  生词本
</a></li><li class="dropdown-item"><!----> <a href="/19书籍阅读/0书籍汇总.html" class="nav-link">
  书籍阅读
</a></li><li class="dropdown-item"><!----> <a href="/20项目/0项目汇总.html" class="nav-link">
  项目
</a></li></ul></div></div><div class="nav-item"><a href="/18实战问题/0.实战中遇到的问题归纳.html" class="nav-link">
  实战问题
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/18实战问题/0.实战中遇到的问题归纳.html" class="sidebar-link">0.实战中遇到的问题归纳</a></li><li><a href="/18实战问题/1.mac显示项目树：tree命令.html" class="sidebar-link">1.mac显示项目树：tree命令</a></li><li><a href="/18实战问题/2.语法糖.html" class="sidebar-link">2.语法糖</a></li><li><a href="/18实战问题/3.软件发行版本分类.html" class="sidebar-link">3.软件发行版本分类</a></li><li><a href="/18实战问题/4.strapi.html" class="sidebar-link">4.strapi</a></li><li><a href="/18实战问题/5.系统用户权限不足问题.html" class="sidebar-link">5.系统用户权限问题</a></li><li><a href="/18实战问题/6.RESTful.html" class="sidebar-link">6.RESTful</a></li><li><a href="/18实战问题/7.一台服务器部署多个Web项目.html" class="sidebar-link">7.一台服务器部署多个Web项目</a></li><li><a href="/18实战问题/8.各种报错.html" class="sidebar-link">8.遇过的报错</a></li><li><a href="/18实战问题/9.Browsersync网页自动刷新.html" class="sidebar-link">9.实时预览</a></li><li><a href="/18实战问题/10.爬取掘金、简书、CSDN上的markdown文章.html" class="sidebar-link">10.爬取掘金、简书、CSDN上的markdown文章</a></li><li><a href="/18实战问题/11.gitalk.html" class="sidebar-link">11.添加Gitalk评论插件到博客</a></li><li><a href="/18实战问题/12.绑定自己的域名到gitpages.html" class="sidebar-link">12.绑定自己的域名到gitpage,并强制使用HTTPS</a></li><li><a href="/18实战问题/13.MongoDB在Mac上连不上.html" class="sidebar-link">13.MongoDB在Mac上连不上.md</a></li><li><a href="/18实战问题/14.hexo博客搭建.html" class="sidebar-link">14. hexo博客搭建.md</a></li><li><a href="/18实战问题/15.IEEE754.html" class="active sidebar-link">15.IEEE 754</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/18实战问题/15.IEEE754.html#_1-2-3-问题" class="sidebar-link">1 + 2 != 3 问题</a></li><li class="sidebar-sub-header"><a href="/18实战问题/15.IEEE754.html#浮点数丢失产生原因" class="sidebar-link">浮点数丢失产生原因</a></li><li class="sidebar-sub-header"><a href="/18实战问题/15.IEEE754.html#什么是ieee-745浮点数表示法" class="sidebar-link">什么是IEEE-745浮点数表示法</a></li><li class="sidebar-sub-header"><a href="/18实战问题/15.IEEE754.html#科普科学计数法" class="sidebar-link">科普科学计数法</a></li></ul></li><li><a href="/18实战问题/16.postman.html" class="sidebar-link">16.postman</a></li><li><a href="/18实战问题/17.dignifiedfilm开发经验.html" class="sidebar-link">17.dignifiedfilm开发经验</a></li><li><a href="/18实战问题/18.Mac终端相关问题.html" class="sidebar-link">18.Mac终端相关问题</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_15-ieee-754"><a href="#_15-ieee-754" class="header-anchor">#</a> 15.IEEE 754</h1> <h2 id="_1-2-3-问题"><a href="#_1-2-3-问题" class="header-anchor">#</a> 1 + 2 != 3 问题</h2> <p><img src="https://gitee.com/hello_hww/img/raw/master/img1/20200810155324.png" alt=""></p> <p>由于不同机器所选用的基数、尾数位长度和阶码位长度不同，因此对浮点数的表示有较大差别，这不利于软件在不同计算机之间的移植。为此，美国IEEE（电器及电子工程师协会）提出了一个从系统角度支持浮点数的表示方法，称为IEEE754标准（IEEE，1985），当今流行的计算机几乎都采用了这一标准。</p> <p>Java中浮点数，既float和double，都是采用的IEEE754标准。无论在java python javaScript里面都存在 1 + 2 != 3 问题，这个问题的产生根源在于<code>计算存储数字是二进制，对无限循环小数和无理数采用双精度64位double浮点数_float为32位,即52位小数+11位指数+1位符号。超过52位小数溢出而产生精度丢失。</code></p> <p>例如在 chrome js console 中：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 加法</span>

<span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">=</span> <span class="token number">0.30000000000000004</span>

<span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.7</span> <span class="token operator">=</span> <span class="token number">0.7999999999999999</span>

<span class="token number">0.2</span> <span class="token operator">+</span> <span class="token number">0.4</span> <span class="token operator">=</span> <span class="token number">0.6000000000000001</span>

<span class="token comment">// 减法</span>

<span class="token number">0.3</span> <span class="token operator">-</span> <span class="token number">0.2</span> <span class="token operator">=</span> <span class="token number">0.09999999999999998</span>

<span class="token number">1.5</span> <span class="token operator">-</span> <span class="token number">1.2</span> <span class="token operator">=</span> <span class="token number">0.30000000000000004</span>

<span class="token comment">// 乘法</span>

<span class="token number">0.8</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">=</span> <span class="token number">2.4000000000000004</span>

<span class="token number">19.9</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">=</span> <span class="token number">1989.9999999999998</span>

<span class="token comment">// 除法</span>

<span class="token number">0.3</span> <span class="token operator">/</span> <span class="token number">0.1</span> <span class="token operator">=</span> <span class="token number">2.9999999999999996</span>

<span class="token number">0.69</span> <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">=</span> <span class="token number">0.06899999999999999</span>

<span class="token comment">// 比较</span>

<span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">===</span> <span class="token number">0.3</span> <span class="token comment">// false</span>

<span class="token punctuation">(</span><span class="token number">0.3</span> <span class="token operator">-</span> <span class="token number">0.2</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token punctuation">(</span><span class="token number">0.2</span> <span class="token operator">-</span> <span class="token number">0.1</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>这个问题并不只是在Javascript中才会出现，任何使用二进制浮点数的编程语言都会有这个问题，只不过在 C++/C#/Java 这些语言中已经封装好了方法来避免精度的问题，而JavaScript是一门弱类型的语言，从设计思想上就没有对浮点数有个严格的数据类型，所以精度误差的问题就显得格外突出。</p> <h2 id="浮点数丢失产生原因"><a href="#浮点数丢失产生原因" class="header-anchor">#</a> 浮点数丢失产生原因</h2> <p>JavaScript 中的数字类型只有 Number 一种，Number 类型采用 IEEE754 标准中的 “双精度浮点数” 来表示一个数字，不区分整数和浮点数。</p> <h2 id="什么是ieee-745浮点数表示法"><a href="#什么是ieee-745浮点数表示法" class="header-anchor">#</a> 什么是IEEE-745浮点数表示法</h2> <p>IEEE-745浮点数表示法是一种可以精确地表示分数的二进制示法，比如1/2，1/8，1/1024</p> <p>十进制小数如何表示为转为二进制</p> <p>十进制整数转二进制</p> <p>十进制整数换成二进制一般都会：1=&gt;1 2=&gt;10 3=&gt;101 4=&gt;100 5=&gt;101 6=&gt;110</p> <p>6/2=3…0</p> <p>3/2=1…1</p> <p>1/2=0…1</p> <p>倒过来就是110</p> <p>十进制小数转二进制</p> <p>0.25的二进制</p> <p>0.25*2=0.5 取整是0</p> <p>0.5*2=1.0    取整是1</p> <p>即0.25的二进制为 0.01 ( 第一次所得到为最高位,最后一次得到为最低位)</p> <p>0.8125的二进制</p> <p>0.8125*2=1.625   取整是1</p> <p>0.625*2=1.25     取整是1</p> <p>0.25*2=0.5       取整是0</p> <p>0.5*2=1.0        取整是1</p> <p>即0.8125的二进制是0.1101（第一次所得到为最高位,最后一次得到为最低位）</p> <p>0.1的二进制</p> <p>0.1*2=0.2======取出整数部分0</p> <p>0.2*2=0.4======取出整数部分0</p> <p>0.4*2=0.8======取出整数部分0</p> <p>0.8*2=1.6======取出整数部分1</p> <p>0.6*2=1.2======取出整数部分1</p> <p>0.2*2=0.4======取出整数部分0</p> <p>0.4*2=0.8======取出整数部分0</p> <p>0.8*2=1.6======取出整数部分1</p> <p>0.6*2=1.2======取出整数部分1</p> <p>接下来会无限循环</p> <p>0.2*2=0.4======取出整数部分0</p> <p>0.4*2=0.8======取出整数部分0</p> <p>0.8*2=1.6======取出整数部分1</p> <p>0.6*2=1.2======取出整数部分1</p> <p>所以0.1转化成二进制是：0.0001 1001 1001 1001…（无限循环）</p> <p>0.1 =&gt; 0.0001 1001 1001 1001…（无限循环）</p> <p>同理0.2的二进制是0.0011 0011 0011 0011…（无限循环）</p> <h2 id="科普科学计数法"><a href="#科普科学计数法" class="header-anchor">#</a> 科普科学计数法</h2> <p>科学记数法是一种把一个数表示成a与10的n次幂相乘的形式（1≤a&lt;10，n为整数）的记数法。</p> <p>例如：19971400000000=1.99714×10^13。计算器或电脑表达10的幂是一般是用E或e，也就是1.99714E13=19971400000000。</p> <p>科学记数法的形式是由两个数的乘积组成的。表示为a×10^b（aEb），其中一个因数为a（1≤|a|&lt;10），另一个因数为10^n。</p> <p>科学计数法的精确度</p> <p>运用科学记数法a×10^n的数字，它的精确度以a的最后一个数在原数中的数位为准。</p> <p>13600，精确到十位，记作：1.360X10^4</p> <p>13600 ，精确到百位，记作：1.36X10^4</p> <p>13600，精确到千位，记作：1.3X10^4</p> <p>十进制的5.0，写成二进制是101.0，相当于1.01×2^2</p> <p>十进制的-5.0，写成二进制是-101.0，相当于-1.01×2^2，推荐阅读《浮点数的二进制表示 》</p> <p>在二进制里面，即a×2^b，1≤a&lt;2，也就是说，a可以写成1.xxxxxx的形式，其中xxxxxx表示小数部分。IEEE 754规定，在计算机内部保存a时，默认这个数的第一位总是1，因此可以被舍去，只保存后面的xxxxxx部分。比如保存1.01的时候，只保存01，等到读取的时候，再把第一位的1加上去。这样做的目的，是节省1位有效数字。以64位浮点数为例，留给a只有52位，将第一位的1舍去以后，等于可以保存53位有效数字</p> <p>所以js浮点数表示的数字为[-1<em>2^53</em>2^1023,1<em>2^53</em>2^1024] ,±1 为符号位，2^53 为小数位(53-1)， 2^1024 1024位指数位(1024*2=2048=2^11为指数位)</p> <p>IEEE-745浮点数表示法存储结构</p> <p>在 IEEE754 中，双精度浮点数采用 64 位存储，即 8 个字节表示一个浮点数 。其存储结构如下图所示：</p> <p>指数位可以通过下面的方法转换为使用的指数值：</p> <p>IEEE-745浮点数表示法记录数值范围</p> <p>从存储结构中可以看出， 指数部分的长度是11个二进制，即指数部分能表示的最大值是 2047（2^11-1）</p> <p>取中间值进行偏移，用来表示负指数，也就是说指数的范围是 [-1023,1024]</p> <p>因此，这种存储结构能够表示的数值范围为 2^1024 到 2^-1023 ，超出这个范围的数无法表示 。2^1024  和 2^-1023  转换为科学计数法如下所示：</p> <p>1.7976931348623157 × 10^308</p> <p>5 × 10^-324</p> <p>因此，JavaScript 中能表示的最大值是 1.7976931348623157 × 10^308，最小值为 5 × 10-324 。java双精度类型 double也是如此。</p> <p>这两个边界值可以分别通过访问 Number 对象的 MAX_VALUE 属性和 MIN_VALUE 属性来获取：</p> <p>Number.MAX_VALUE; // 1.7976931348623157e+308</p> <p>Number.MIN_VALUE; // 5e-324</p> <p>如果数字超过最大值或最小值，JavaScript 将返回一个不正确的值，这称为 “正向溢出(overflow)” 或 “负向溢出(underflow)” 。</p> <p>Number.MAX_VALUE+1 == Number.MAX_VALUE; //true</p> <p>Number.MAX_VALUE+1e292; //Infinity</p> <p>Number.MIN_VALUE + 1; //1</p> <p>Number.MIN_VALUE - 3e-324; //0</p> <p>Number.MIN_VALUE - 2e-324; //5e-324</p> <p>IEEE-745浮点数表示法数值精度</p> <p>在 64 位的二进制中，符号位决定了一个数的正负，指数部分决定了数值的大小，小数部分决定了数值的精度。</p> <p>IEEE754 规定，有效数字第一位默认总是1 。因此，在表示精度的位数前面，还存在一个 “隐藏位” ，固定为 1 ，但它不保存在 64 位浮点数之中。也就是说，有效数字总是 1.xx...xx 的形式，其中 xx..xx 的部分保存在 64 位浮点数之中，最长为52位 。所以，JavaScript 提供的有效数字最长为 53 个二进制位，其内部实际的表现形式为：</p> <p>(-1)^符号位 * 1.xx...xx * 2^指数位</p> <p>这意味着，JavaScript 能表示并进行精确算术运算的整数范围为：[-2^53-1，2^53-1]，即从最小值 -9007199254740991 到最大值 9007199254740991 之间的范围 。</p> <p>Math.pow(2, 53)-1 ; // 9007199254740991</p> <p>-Math.pow(2, 53)-1 ; // -9007199254740991</p> <p>可以通过 Number.MAX_SAFE_INTEGER 和  Number.MIN_SAFE_INTEGER 来分别获取这个最大值和最小值。</p> <p>console.log(Number.MAX_SAFE_INTEGER) ; // 9007199254740991</p> <p>console.log(Number.MIN_SAFE_INTEGER) ; // -9007199254740991</p> <p>对于超过这个范围的整数，JavaScript 依旧可以进行运算，但却不保证运算结果的精度。</p> <p>Math.pow(2, 53) ; // 9007199254740992</p> <p>Math.pow(2, 53) + 1; // 9007199254740992</p> <p>9007199254740993; //9007199254740992</p> <p>90071992547409921; //90071992547409920</p> <p>0.923456789012345678;//0.9234567890123456</p> <p>IEEE-745浮点数表示法数值精度丢失</p> <p>计算机中的数字都是以二进制存储的，二进制浮点数表示法并不能精确的表示类似0.1这样 的简单的数字</p> <p>如果要计算 0.1 + 0.2 的结果，计算机会先把 0.1 和 0.2 分别转化成二进制，然后相加，最后再把相加得到的结果转为十进制</p> <p>但有一些浮点数在转化为二进制时，会出现无限循环 。比如， 十进制的 0.1 转化为二进制，会得到如下结果：</p> <p>0.1 =&gt; 0.0001 1001 1001 1001…（无限循环）</p> <p>0.2 =&gt; 0.0011 0011 0011 0011…（无限循环）</p> <p>而存储结构中的尾数部分最多只能表示 53 位。为了能表示 0.1，只能模仿十进制进行四舍五入了，但二进制只有 0 和 1 ， 于是变为 0 舍 1 入 。 因此，0.1 在计算机里的二进制表示形式如下：</p> <p>0.1 =&gt; 0.0001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 1001 101</p> <p>0.2 =&gt; 0.0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 0011 001</p> <p>用标准计数法表示如下：</p> <p>0.1 =&gt; (−1)0 × 2^4 × (1.1001100110011001100110011001100110011001100110011010)2</p> <p>0.2 =&gt; (−1)0 × 2^3 × (1.1001100110011001100110011001100110011001100110011010)2</p> <p>在计算浮点数相加时，需要先进行 “对位”，将较小的指数化为较大的指数，并将小数部分相应右移：</p> <p>最终，“0.1 + 0.2” 在计算机里的计算过程如下：</p> <p>经过上面的计算过程，0.1 + 0.2 得到的结果也可以表示为：</p> <p>(−1)0 × 2−2 × (1.0011001100110011001100110011001100110011001100110100)2=&gt;.0.30000000000000004</p> <p>通过 JS 将这个二进制结果转化为十进制表示：</p> <p>(-1)<strong>0 * 2</strong>-2 * (0b10011001100110011001100110011001100110011001100110100 * 2**-52); //0.30000000000000004</p> <p>console.log(0.1 + 0.2) ; // 0.30000000000000004</p> <p>这是一个典型的精度丢失案例，从上面的计算过程可以看出，0.1 和 0.2 在转换为二进制时就发生了一次精度丢失，而对于计算后的二进制又有一次精度丢失 。因此，得到的结果是不准确的。</p> <p>几乎所有的编程语言浮点数都是都采用IEEE浮点数算术标准</p> <p>在C或者java里面，double是64位浮点数，float 是32 浮点数:  1bit符号  8bit指数部分 23bit尾数。推荐阅读《JAVA 浮点数的范围和精度》</p> <p>long与double在java中本身都是用64位存储的,但是他们的存储方式不同，导致double可储存的范围比long大很多</p> <p>long可以准确存储19位数字，而double只能准备存储16位数字（实际测试，是17位，）。double由于有exp位，可以存16位以上的数字，但是需要以低位的不精确作为代价。如果一个大于17位的long型数字存到double上，就会丢失数字末尾的精度</p> <p>如果需要高于19位数字的精确存储，则必须用BigInteger来保存，当然会牺牲一些性能。</p> <p>java 基本数据类型</p> <p>基本类型存储需求位数bit数取值范围取值范围</p> <p>byte1byte8bit1*8(8)-2^7~2^7-1-128~127</p> <p>short2byte16bit2*8(16)-2^15~2^15-1-32768~32767</p> <p>int4byte32bit4*8(32)-2^31~2^31-1-2147483648~2147483647</p> <p>long8byte64bit8*8(64)-2^63~2^63-1=-9223372036854775808~9223372036854775807</p> <p>float4byte32bit4<em>8(32)3.4028235E38~1.4E-453.4028235</em>10^38~1.4*10^-45</p> <p>double8byte64bit8<em>8(64)-2^1023~2^10241.7976931348623157</em>10^308~4.9*10^-324</p> <p>char2byte16bit2*8(16)2^16 - 1unicode编码范围</p> <p>java中char类型占2个字节、16位可以存放汉子，字母和数字占一个字节，一个字节8位，中文占2个字节，16位。</p> <p>在表中，long最大为=2^63-1，而double为2^1024，</p> <p>java中int和float都是32位，long和double都是64位。为什么float和double表示的范围大那么多呢？因为double采用IEEE-745浮点数表示法</p> <p>double是n*2^m(n乘以2的m次方)这种形式存储的，只需要记录n和m两个数就行了，m的值影响范围大，所以表示的范围比long大。</p> <p>但是m越大，n的精度就越小，所以double并不能把它所表示的范围里的所有数都能精确表示出来，而long就可以。</p> <p>float浮点数，小数点后第7位是部分准确的。例如，1.0000004就是1.00000035通过得到的，其实际保存和1.0000003相同。1.0000006也是通过舍入得到的。再往前第6位及以后均可以通过小数准确表示出来。通常说float数据的有效位是6~7位，也是这个原因。一般来说，无论是整数或者小数，用float表示时，从左边第一个非0的数字算起，从高到低的7位是准确的。此后的数位是不能保证精确的。</p> <p>double双精度浮点数小数部分有52位，和上面类似，最低6位(2^-52,2^-51,......)表示的规格化小数如下所示。从图中可以看出，双精度浮点数能准确表示到小数点后第15位，第16位部分准确。用double表示时，从左边第一个非0的数字起，从高到低的16位是准确的，此后的数位不一定精确</p> <p>尽管浮点数表示的范围很广，但由于精度损失的存在，加上幂次的放大作用，一个浮点数实际上是表示了周围的一个有理数区间。如果将浮点数绘制到一个数轴上，直观上看，靠近0的部分，浮点数出现较密集。越靠近无穷大，浮点数分布越稀疏，一个浮点值代表了周围一片数据。如下图所示。从这个意义上来说，浮点数不宜直接比较相等，它们是代表了一个数据范围。实际应用中，如果要使用浮点数计算，一定要考虑精度问题。在满足精度要求的前提下，计算结果才是有效的。</p> <p>在计算精度要求情形下，例如商业计算等，应该避免使用浮点数，严格采取高精度计算。</p> <p>浮点数丢失解决方案</p> <p>我们常用的分数（特别是在金融的计算方面）都是十进制分数1/10，1/100等。或许以后电路设计或许会支持十进制数字类型以避免这些舍入问题。在这之前，你更愿意使用大整数进行重要的金融计算，例如，要使用整数‘分’而不是使用小数‘元’进行货比单位的运算</p> <p>即在运算前我们把参加运算的数先升级(10的X的次方)到整数，等运算完后再降级(0.1的X的次方)。</p> <p>在java里面有BigDecimal库，js里面有big.jsjs-big-decimal.js。当然BCD编码就是为了十进制高精度运算量制。</p> <p>BCD编码</p> <p>BCD编码(一般指8421BCD码形式)亦称二进码十进数或二-十进制代码。用4位二进制数来表示1位十进制数中的0~9这10个数。一般用于高精度计算。比如会计制度经常需要对很长的数字串作准确的计算。相对于一般的浮点式记数法，采用BCD码，既可保存数值的精确度，又可免去使电脑作浮点运算时所耗费的时间。</p> <p>为什么采用二进制</p> <p>二进制在电路设计中物理上更易实现，因为电子器件大多具有两种稳定状态，比如晶体管的导通和截止，电压的高和低，磁性的有和无等。而找到一个具有十个稳定状态的电子器件是很困难的。</p> <p>二进制规则简单，十进制有55种求和与求积的运算规则，二进制仅有各有3种，这样可以简化运算器等物理器件的设计。另外，计算机的部件状态少，可以增强整个系统的稳定性。</p> <p>与逻辑量相吻合。二进制数0和1正好与逻辑量“真”和“假”相对应，因此用二进制数表示二值逻辑显得十分自然。</p> <p>可靠性高。二进制中只使用0和1两个数字，传输和处理时不易出错，因而可以保障计算机具有很高的可靠性</p> <p>我觉得主要还是因为第一条。如果比如能够设计出十进制的元器件，那么对于设计其运算器也不再话下。</p> <p>JS数字精度丢失的一些典型问题</p> <p>两个简单的浮点数相加</p> <p>0.1 + 0.2 != 0.3 // true</p> <p>toFixed 不会四舍五入（Chrome）</p> <p>1.335.toFixed(2) // 1.33</p> <p>再问问一个问题 ：在js数字类型中浮点数的最高精度多少位小数？（16位 or 17位？……why？</p> <p>JavaScript 能表示并进行精确算术运算的整数范围为：[-2^53-1，2^53-1]，即从最小值 -9007199254740991 到最大值 9007199254740991 之间的范围。'9007199254740991'.length//16</p> <p>IEEE754 规定，有效数字第一位默认总是1 。因此，在表示精度的位数前面，还存在一个 “隐藏位” ，固定为 1 ，但它不保存在 64 位浮点数之中。也就是说，有效数字总是 1.xx...xx 的形式，其中 xx..xx 的部分保存在 64 位浮点数之中，最长为52位 。所以，JavaScript 提供的有效数字最长为 53 个二进制位</p> <p>let a=1/3</p> <p>a.toString();//&quot;0.3333333333333333&quot;</p> <p>a.toString();.length//18</p> <p>a<em>3===0.3333333333333333</em>3===1</p> <p>0.3333333333333332*3!==1</p> <p>作者：ksfkf
链接：https://www.jianshu.com/p/7c636d8f18d5
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">8/11/2020, 6:14:10 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/18实战问题/14.hexo博客搭建.html" class="prev">
        14. hexo博客搭建.md
      </a></span> <span class="next"><a href="/18实战问题/16.postman.html">
        16.postman
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7cfd3afd.js" defer></script><script src="/assets/js/2.7c2e0a4d.js" defer></script><script src="/assets/js/119.379e4cb6.js" defer></script><script src="/assets/js/5.bf8043b7.js" defer></script>
  </body>
</html>
